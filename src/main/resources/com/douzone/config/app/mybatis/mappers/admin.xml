<?xml version="1.0" encoding="UTF-8" ?> 

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="admin">
	
	<select id="getCompList" parameterType="string" resultType="companyvo">
		select a.comp_seq as compSeq, b.comp_cd as compCd, a.comp_name as compName 
		from t_co_comp_multi a, t_co_comp b
		where a.comp_seq = b.comp_seq
		and lang_code = #{langCode}
		order by a.comp_seq + 0;
	</select>
	
	<select id="getCompInfo" parameterType="string" resultType="companyvo">
		select a.comp_seq as compSeq, if(a.use_yn = 'Y', '사용', '미사용') as useYn, a.owner_name as ownerName, a.comp_regist_num as compRegistNum,
			a.comp_num as compNum, a.standard_code as standardCode, a.comp_cd as compCd, a.order_num as orderNum,
			a.biz_condition as bizCondition, a.item, a.tel_num as telNum, a.fax_num as faxNum, a.zip_code as zipCode,
		    a.addr, a.detail_addr as detailAddr, a.homepg_addr as homepgAddr, (case(a.native_lang_code)when'kr' then '한국어' else '영어' end) as nativeLangCode, 
		    a.comp_domain as compDomain, b.comp_name as compName, c.comp_name as compNameEn
		from
			(select a.comp_seq, a.use_yn, b.owner_name, a.comp_regist_num, a.comp_num, a.standard_code,
					a.comp_cd, a.order_num, b.biz_condition, b.item, a.tel_num, a.fax_num, a.zip_code,
			        b.addr, b.detail_addr, a.homepg_addr, a.native_lang_code, a.comp_domain
			from t_co_comp a, t_co_comp_multi b
			where a.comp_seq = b.comp_seq
			and b.lang_code = 'kr'
			and a.comp_seq = #{compSeq}) a
		left outer join t_co_comp_multi b
		on a.comp_seq = b.comp_seq
		and b.lang_code = 'kr'
		left outer join t_co_comp_multi c
		on a.comp_seq = c.comp_seq
		and c.lang_code = 'en'
	</select>
	
	<insert id="insertComp" parameterType="companyvo">
		
		insert into t_co_comp values(#{compSeq}, 'demo', #{compCd}, '0', 'B', #{compRegistNum},
		 #{compNum}, #{standardCode}, 'Y', #{telNum}, #{faxNum}, #{homepgAddr}, null, #{compDomain}, null,
		  '', #{zipCode}, 'N', '', '', #{nativeLangCode}, (select max(a.order_num)+1 from t_co_comp a), #{useYn}, 'eap', '0101', now(),
		   null, null, 'N', 'N', 'N')
	</insert>
	
	<insert id="insertCompMulti" parameterType="companyvo">
		insert into t_co_comp_multi values(#{compSeq}, #{langCode}, 'demo', #{compName}, null,
		 '김세준', null, null, null, #{addr}, #{detailAddr}, #{useYn}, '1010', now(), null, null, #{compNickname})
	</insert>
</mapper>